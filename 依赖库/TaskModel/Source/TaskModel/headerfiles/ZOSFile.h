///////////////////////////////////////////////////////////////////////////////
/******************************************************************************
	Project		ZMediaServer
	ZOSFile		Header File
	Create		20100706		ZHAOTT
******************************************************************************/
///////////////////////////////////////////////////////////////////////////////
#ifndef	_ZOSFILE_H_
#define	_ZOSFILE_H_
///////////////////////////////////////////////////////////////////////////////
#include "Common.h"
///////////////////////////////////////////////////////////////////////////////
class ZOSFile : public ZObject
{
///////////////////////////////////////////////////////////////////////////////
public:
	ZOSFile();
	~ZOSFile();
///////////////////////////////////////////////////////////////////////////////
public:
	BOOL	IsOpen();
	BOOL	IsDir();
	BOOL	IsReadOnly();
	BOOL	IsReadable();
	BOOL	IsWriteable();
///////////////////////////////////////////////////////////////////////////////
public:
	BOOL	Open(const char* sName,BOOL bReadOnly = TRUE,BOOL bAppend = FALSE);
	BOOL	Create(const char* sName,BOOL bCreateNew = TRUE);
	BOOL	Close();
///////////////////////////////////////////////////////////////////////////////
public:
	int		Read(char* sdata,int ndata);
	int		Write(const char* sdata,int ndata);
///////////////////////////////////////////////////////////////////////////////
public:
	int		Seek(UINT64 nPos);
///////////////////////////////////////////////////////////////////////////////
public:
	int		GetHandle();
	char*	GetPath();
    wchar_t* GetPathW();
///////////////////////////////////////////////////////////////////////////////
public:
	virtual	UINT64	GetPosition();
	virtual	UINT64	SetPosition(UINT64 nPos);
	virtual	UINT64	GetSize();
///////////////////////////////////////////////////////////////////////////////
public:
	static BOOL FileExist(const char* sFileFullPath);
    static UINT64 FileSize(const char* sFileFullPath);
    static BOOL DelFile(const char* sFileFullPath);
    static BOOL DelDir(const char* sDir);
#ifdef _WIN32_
    BOOL	OpenW(const wchar_t* sName,BOOL bReadOnly = TRUE,BOOL bAppend = FALSE);
    BOOL	CreateW(const wchar_t* sName,BOOL bCreateNew = TRUE);
    static BOOL FileExistW(const wchar_t* sFileFullPath);
    static UINT64 FileSizeW(const wchar_t* sFileFullPath);
    static BOOL DelFileW(const wchar_t* sFileFullPath);
    static BOOL DelDirW(const wchar_t* sDir);
#endif
///////////////////////////////////////////////////////////////////////////////
protected:
	int		m_hFile;
	int		m_nFileFlag;
	char	m_sPath[MAX_FILE_PATH+4];
    wchar_t m_sPathW[MAX_FILE_PATH+4];
	BOOL	m_bDir;
	BOOL	m_bEOF;
    BOOL    m_bReadOnlyFlag;
///////////////////////////////////////////////////////////////////////////////
protected:
	UINT64	m_nSize;
	UINT64	m_nPosition;
	time_t	m_tModData;
///////////////////////////////////////////////////////////////////////////////
};
///////////////////////////////////////////////////////////////////////////////
#endif	//_ZOSFILE_H_
///////////////////////////////////////////////////////////////////////////////
