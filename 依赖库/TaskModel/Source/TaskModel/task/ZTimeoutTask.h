///////////////////////////////////////////////////////////////////////////////
/******************************************************************************
	Project			ZMediaServer
	ZTimeoutTask	Header File
	Create			20100617		ZHAOTT
	Modify			20110621		ZHAOTT
******************************************************************************/
///////////////////////////////////////////////////////////////////////////////
#ifndef	_ZTIMEOUTTASK_H_
#define	_ZTIMEOUTTASK_H_
///////////////////////////////////////////////////////////////////////////////
#include "Common.h"
#include "ZIdleTask.h"

class ZTimeoutTask : public ZIdleTask
{
///////////////////////////////////////////////////////////////////////////////
public:
	ZTimeoutTask(CONST CHAR* sTaskName);
	virtual ~ZTimeoutTask();
///////////////////////////////////////////////////////////////////////////////
public:
	BOOL	SetTimeoutTask(ZTask* pTask);
	BOOL	SetTimeout(int nMSec);
    int     GetTimeout();
	BOOL	RefreshTimeout();
///////////////////////////////////////////////////////////////////////////////
protected:
	virtual	BOOL	OnTimeoutEvent();
	virtual	BOOL	OnIdleEvent();

///////////////////////////////////////////////////////////////////////////////
public:
	virtual int		Create();
	virtual	int		Close();
protected:
	virtual	int		Run(int nEvent = 0);
///////////////////////////////////////////////////////////////////////////////
private:
	ZTask*		m_pTimeoutTask;
	UINT64		m_nTimeoutMTime;
	UINT64		m_nTimeoutMSec;
	ZOSMutex	m_TimeoutMutex;
///////////////////////////////////////////////////////////////////////////////
};
///////////////////////////////////////////////////////////////////////////////
#endif	//_ZTIMEOUTTASK_H_
///////////////////////////////////////////////////////////////////////////////
