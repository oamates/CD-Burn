///////////////////////////////////////////////////////////////////////////////
/******************************************************************************
	Project			ZMediaServer
	ZAuthenticator	Header File
	Create			20121205		ZHAOTT
******************************************************************************/
///////////////////////////////////////////////////////////////////////////////
#ifndef	_ZAUTHENTICATOR_H_
#define	_ZAUTHENTICATOR_H_
///////////////////////////////////////////////////////////////////////////////
#include "Common.h"
#include "ZAuth.h"
///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////
class ZAuthenticator : public ZAuth
{
///////////////////////////////////////////////////////////////////////////////
public:
	ZAuthenticator();
	virtual	~ZAuthenticator();
///////////////////////////////////////////////////////////////////////////////
public:
	virtual	BOOL		Authorization();
	virtual	BOOL		Authentication();
///////////////////////////////////////////////////////////////////////////////
public:
	virtual	AUTH_TYPE	GetAuthType();
	virtual	AUTH_TYPE	SetAuthType(AUTH_TYPE nType);
///////////////////////////////////////////////////////////////////////////////
public:
	virtual	BOOL		GetAuthData(CHAR* sAuth,UINT* nAuth);
	virtual	BOOL		CheckAuthData(CHAR* sAuth,UINT nAuth);
///////////////////////////////////////////////////////////////////////////////
public:
	virtual	BOOL		SetUserNamePassword(CHAR* sUser,CHAR* sPassword);
	virtual	BOOL		SetRealmNonce(CHAR* sRealm,CHAR* sNonce);
	virtual	BOOL		SetMethodURL(CHAR* sMethod,CHAR* sURL);
///////////////////////////////////////////////////////////////////////////////
protected:
	virtual	BOOL		GetBasicAuthentication();
	virtual	BOOL		GetDigestAuthentication();
///////////////////////////////////////////////////////////////////////////////
protected:
	CHAR				m_sUser[MAX_KEY_LABEL+4];
	CHAR				m_sPassword[MAX_KEY_LABEL+4];
///////////////////////////////////////////////////////////////////////////////
protected:
	CHAR				m_sAuthenticationRealm[MAX_KEY_LABEL+4];
	CHAR				m_sAuthenticationNonce[MAX_KEY_LABEL+4];
	CHAR				m_sAuthenticationMethod[MAX_KEY_LABEL+4];
	CHAR				m_sAuthenticationURL[MAX_KEY_LABEL+4];
///////////////////////////////////////////////////////////////////////////////
protected:
	BOOL				m_bAuthenticationFlag;
	AUTH_TYPE			m_nAuthenticationType;
	CHAR				m_sAuthenticationData[MAX_MESSAGE_DATA+4];
///////////////////////////////////////////////////////////////////////////////
};
///////////////////////////////////////////////////////////////////////////////
#endif	//_ZAUTHENTICATOR_H_
///////////////////////////////////////////////////////////////////////////////
