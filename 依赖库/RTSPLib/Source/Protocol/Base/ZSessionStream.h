///////////////////////////////////////////////////////////////////////////////
/******************************************************************************
	Project			ZMediaServer
	ZSessionStream	Header File
	Create			20120221		ZHAOTT		SESSION
******************************************************************************/
///////////////////////////////////////////////////////////////////////////////
#ifndef	_ZSESSIONSTREAM_H_
#define	_ZSESSIONSTREAM_H_
///////////////////////////////////////////////////////////////////////////////
#include "ZSession.h"
#include "ZBaseStream.h"
///////////////////////////////////////////////////////////////////////////////
class	ZBaseStream;
class	ZSessionStream;
///////////////////////////////////////////////////////////////////////////////
class ZSessionStream : public ZObject
{
///////////////////////////////////////////////////////////////////////////////
public:
	ZSessionStream();
	virtual	~ZSessionStream();
///////////////////////////////////////////////////////////////////////////////
public:
	virtual	BOOL	RequestEvent();
	virtual	BOOL	RemoveEvent();
///////////////////////////////////////////////////////////////////////////////
public:
	void			AttachStream(ZBaseStream* pStream);
	void			DetachStream(ZBaseStream* pStream);
///////////////////////////////////////////////////////////////////////////////
public:
	ZBaseStream*	GetStream();
///////////////////////////////////////////////////////////////////////////////
public:
	virtual	char*	GetBuffer();
	virtual	int		GetBufferLength();
	virtual	int		GetBufferSize();
	virtual	int		MoveBuffer(int nLen);
///////////////////////////////////////////////////////////////////////////////
public:
	virtual	int		ReadStream();
	virtual	int		SendStream(const char* sData,int nData);
    virtual int     SendStreamNoWritableCheck(const char* sData, int nData);
	virtual	int		CleanStream();
///////////////////////////////////////////////////////////////////////////////
protected:
	ZOSMutex		m_SessionStreamMutex;
	ZBaseStream*	m_pSessionStream;
	char*			m_sBuffer;
	int				m_nBuffer;
	int				m_nSize;
///////////////////////////////////////////////////////////////////////////////
};
///////////////////////////////////////////////////////////////////////////////
#endif	//_ZSESSIONSTREAM_H_
///////////////////////////////////////////////////////////////////////////////
