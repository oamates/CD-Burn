///////////////////////////////////////////////////////////////////////////////
/******************************************************************************
	Project		ZMediaServer
	ZOSHeap		Header File
	Create		20100626		ZHAOTT
******************************************************************************/
///////////////////////////////////////////////////////////////////////////////
#ifndef	_ZOSHEAP_H_
#define	_ZOSHEAP_H_
///////////////////////////////////////////////////////////////////////////////
#include "Common.h"
#include "ZOSCond.h"
#include "ZOSMutex.h"
#include "ZOSThread.h"
///////////////////////////////////////////////////////////////////////////////
#define	DEFAULT_MINI_ELEMENT	2
///////////////////////////////////////////////////////////////////////////////
class	ZOSHeap;
class	ZOSHeapElement;
///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////
class	ZOSHeapElement
{
///////////////////////////////////////////////////////////////////////////////
public:
	ZOSHeapElement(UINT64 nValue = 0,void* pObject = 0);
	virtual ~ZOSHeapElement();
///////////////////////////////////////////////////////////////////////////////
public:
	UINT64		GetValue();
	UINT64		SetValue(UINT64 nValue);
	void*		GetObject();
	void*		SetObject(void* pObject);
	ZOSHeap*	GetHeap();
///////////////////////////////////////////////////////////////////////////////
public:
	BOOL		Remove();
///////////////////////////////////////////////////////////////////////////////
private:
	UINT64		m_nValue;
	void*		m_pObject;
	ZOSHeap*	m_pHeap;
///////////////////////////////////////////////////////////////////////////////
public:
	friend	class	ZOSHeap;
///////////////////////////////////////////////////////////////////////////////
};
///////////////////////////////////////////////////////////////////////////////
class	ZOSHeap : public ZObject
{
///////////////////////////////////////////////////////////////////////////////
public:
	ZOSHeap(CONST CHAR* sName,int nDefaultSize = DEFAULT_MINI_ELEMENT);
	virtual ~ZOSHeap();
///////////////////////////////////////////////////////////////////////////////
public:
	int				HeapSize();
	int				HeapCount();
///////////////////////////////////////////////////////////////////////////////
public:
	ZOSHeapElement*	Insert(ZOSHeapElement* pElement);
	ZOSHeapElement*	Extract(int nIndex);
	ZOSHeapElement*	ExtractMin();
	ZOSHeapElement*	Peek(int nIndex);
	ZOSHeapElement*	PeekMin();
	ZOSHeapElement*	Remove(ZOSHeapElement* pElement);
	ZOSHeapElement*	RemoveAll();
///////////////////////////////////////////////////////////////////////////////
protected:
	ZOSHeapElement**	m_ppElement;
	int					m_nIndex;
	int					m_nSize;
///////////////////////////////////////////////////////////////////////////////
};
///////////////////////////////////////////////////////////////////////////////
#endif	//_ZOSHEAP_H_
///////////////////////////////////////////////////////////////////////////////
